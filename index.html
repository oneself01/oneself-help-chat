<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ONESELF ç¤¾å†…ãƒ˜ãƒ«ãƒ—AI</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #f7f3ff 0, #f3f6ff 40%, #ffffff 100%);
      color: #111827;
    }

    .app {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px 16px;
    }

    .card {
      width: 100%;
      max-width: 960px;
      background: #ffffff;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(15, 23, 42, 0.15);
      padding: 24px 24px 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: #ffdd66;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .brand-logo img {
      width: 28px;
      height: 28px;
      object-fit: contain;
      display: block;
    }

    .brand-title {
      font-weight: 700;
      font-size: 16px;
    }

    .badge {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4f46e5;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
      color: #6b7280;
    }

    .header-right span.label {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
    }

    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 4px;
    }

    .tab-btn {
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      font-size: 11px;
      padding: 4px 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      color: #4b5563;
    }

    .tab-btn.active {
      background: #111827;
      color: #f9fafb;
      border-color: #111827;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.8fr);
      gap: 16px;
    }

    @media (max-width: 840px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .hint-box {
      border-radius: 18px;
      border: 1px solid #e5e7eb;
      padding: 12px 14px;
      font-size: 12px;
      background: #f9fafb;
      line-height: 1.6;
    }

    .hint-title {
      font-weight: 600;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .hint-list {
      margin: 4px 0 0;
      padding-left: 18px;
    }

    .hint-list li {
      margin: 2px 0;
    }

    .examples {
      margin-top: 8px;
      font-size: 11px;
      color: #6b7280;
    }

    .examples code {
      background: #111827;
      color: #f9fafb;
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 10px;
    }

    .chat-card {
      border-radius: 18px;
      border: 1px solid #e5e7eb;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background: #f9fafb;
    }

    .chat-log {
      background: #ffffff;
      border-radius: 14px;
      padding: 12px;
      height: 340px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
      border: 1px solid #e5e7eb;
    }

    .message-row {
      display: flex;
      align-items: flex-end;
      gap: 6px;
      max-width: 88%;
    }

    .message-row.user {
      margin-left: auto;
      justify-content: flex-end;
    }

    .message-row.bot {
      justify-content: flex-start;
    }

    .avatar {
      width: 40px;
      height: 40px;
      margin-right: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .avatar img {
      width: 36px;
      height: 36px;
      border-radius: 9999px;
      object-fit: cover;
      display: block;
    }

    .bubble {
      padding: 8px 11px;
      border-radius: 16px;
      font-size: 13px;
      line-height: 1.5;
      word-break: break-word;
    }

    .message-row.user .bubble {
      background: #111827;
      color: #ffffff;
      border-bottom-right-radius: 4px;
    }

    .message-row.bot .bubble {
      background: #f3f4ff;
      color: #111827;
      border-bottom-left-radius: 4px;
    }

    .bubble.thinking {
      font-style: italic;
      color: #6b7280;
      background: #f3f4f6;
    }

    .chat-input-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 6px;
    }

    textarea {
      flex: 1;
      resize: none;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      padding: 10px 14px;
      font-size: 13px;
      outline: none;
    }

    textarea:focus {
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79, 70, 229, 0.15);
    }

    /* ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’å°‘ã—è–„ã */
    textarea::placeholder {
      color: #d1d5db;
    }

    button {
      font-family: inherit;
    }

    .send-btn {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 13px;
      font-weight: 600;
      background: #111827;
      color: #ffffff;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .send-btn:disabled {
      opacity: 0.5;
      cursor: default;
    }

    .note {
      margin-top: 4px;
      font-size: 10px;
      color: #9ca3af;
      text-align: left;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="card">
      <header>
        <div class="brand">
          <div class="brand-logo">
            <img src="kuma.png" alt="ONESELFãã¾" />
          </div>
          <div>
            <div class="brand-title">ONESELF ç¤¾å†…ãƒ˜ãƒ«ãƒ—AI</div>
            <div style="font-size:11px;color:#6b7280;">
              åº—èˆ—æƒ…å ±ãƒ»æ¸…æƒãƒ«ãƒ¼ãƒ«ãƒ»ãƒˆãƒ©ãƒ–ãƒ«å¯¾å¿œãªã©ã‚’ç´ æ—©ãç¢ºèªã§ãã¾ã™
            </div>
          </div>
          <span class="badge">ç¤¾å†…ç”¨ï¼ˆè©¦é¨“é‹ç”¨ä¸­ï¼‰</span>
        </div>
        <div class="header-right">
          <span class="label">ç¤¾å†…ç”¨</span>
          <span>å›ç­”ã¯ç¤¾å†…ãƒ«ãƒ¼ãƒ«ã‚’å„ªå…ˆã—ã¦æœ€çµ‚ç¢ºèªã—ã¦ãã ã•ã„</span>
        </div>
      </header>

      <div class="layout">
        <!-- å·¦å´ï¼šèª¬æ˜ -->
        <div>
          <div class="tabs">
            <button class="tab-btn active">
              ğŸ  åº—èˆ—æƒ…å ±
            </button>
            <button class="tab-btn">
              ğŸ§¹ æ¸…æƒãƒ»é‹ç”¨ãƒ«ãƒ¼ãƒ«
            </button>
            <button class="tab-btn">
              ğŸ” ãƒªãƒ¢ãƒ¼ãƒˆãƒ­ãƒƒã‚¯
            </button>
            <button class="tab-btn">
              ğŸ˜¢ ã‚¯ãƒ¬ãƒ¼ãƒ å¯¾å¿œ
            </button>
          </div>

          <div class="hint-box">
            <div class="hint-title">
              <span>ğŸ“Œ ONESELFç¤¾å†…ãƒ˜ãƒ«ãƒ—AI ã§ã™ã€‚</span>
            </div>
            <ul class="hint-list">
              <li>åº—èˆ—æƒ…å ±ï¼ˆä½æ‰€ / é§è»Šå ´ / è¨­å‚™ï¼‰</li>
              <li>é‹ç”¨ãƒ«ãƒ¼ãƒ«ï¼ˆæ¸…æƒ / å…¥é€€å®¤ / äºˆç´„ï¼‰</li>
              <li>ãƒˆãƒ©ãƒ–ãƒ«å¯¾å¿œï¼ˆãƒªãƒ¢ãƒ¼ãƒˆãƒ­ãƒƒã‚¯ / ã‚¯ãƒ¬ãƒ¼ãƒ ï¼‰</li>
              <li>ãã®ä»–ã€ç¤¾å†…ãƒ«ãƒ¼ãƒ«ã®ç¢ºèª</li>
            </ul>
            <div class="examples">
              ä¾‹ï¼š<br />
              <code>æ²¼æ´¥åº—ã®ä½æ‰€ã¯ï¼Ÿ</code><br />
              <code>æ²¼æ´¥åº—ã®é§è»Šå ´ã¯ï¼Ÿ</code><br />
              <code>æ¸…æƒé »åº¦ã‚’æ•™ãˆã¦</code>
            </div>
          </div>
        </div>

        <!-- å³å´ï¼šãƒãƒ£ãƒƒãƒˆ -->
        <div class="chat-card">
          <div id="chat-log" class="chat-log"></div>

          <form id="chat-form" class="chat-input-row">
            <textarea
              id="user-input"
              rows="1"
              placeholder="ç¤¾å†…æ¥­å‹™ã«ã¤ã„ã¦è³ªå•ï¼ˆä¾‹ï¼šæ¸…æƒãƒ«ãƒ¼ãƒ« / é§è»Šå ´ / ãƒˆãƒ©ãƒ–ãƒ«å¯¾å¿œ ãªã©ï¼‰"
            ></textarea>
            <button id="send-btn" class="send-btn" type="submit">
              é€ä¿¡
            </button>
          </form>

          <div class="note">
            â€» äºˆç´„æƒ…å ±ãƒ»å€‹äººæƒ…å ±ã¯å…¥åŠ›ã—ãªã„ã§ãã ã•ã„ã€‚<br />
            â€» å›ç­”å†…å®¹ãŒè¦ç¨‹ã¨ç•°ãªã‚‹å ´åˆã¯ã€ç¤¾å†…ãƒ«ãƒ¼ãƒ«ã‚’å„ªå…ˆã—ã¦ãã ã•ã„ã€‚
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const WORKER_ENDPOINT = "https://aged-mountain-a919.mabekento.workers.dev";

    const chatLog  = document.getElementById("chat-log");
    const form     = document.getElementById("chat-form");
    const input    = document.getElementById("user-input");
    const sendBtn  = document.getElementById("send-btn");

    function addBubble(text, role) {
      const row = document.createElement("div");
      row.className = "message-row " + role;

      if (role === "bot") {
        const icon = document.createElement("div");
        icon.className = "avatar";
        icon.innerHTML = '<img src="kuma.png" alt="ONESELFãã¾" />';
        row.appendChild(icon);
      }

      const bubble = document.createElement("div");
      bubble.className = "bubble";
      bubble.textContent = text;

      row.appendChild(bubble);
      chatLog.appendChild(row);
      chatLog.scrollTop = chatLog.scrollHeight;
    }

    // åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    addBubble(
      "ç¤¾å†…æ¥­å‹™ã«ã¤ã„ã¦è‡ªç”±ã«è³ªå•ã—ã¦ãã ã•ã„ã€‚ï¼ˆæ¸…æƒãƒ«ãƒ¼ãƒ« / ãƒªãƒ¢ãƒ¼ãƒˆãƒ­ãƒƒã‚¯ / MEOå¯¾å¿œ ãªã©ï¼‰",
      "bot"
    );

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const text = input.value.trim();
      if (!text) return;

      addBubble(text, "user");
      input.value = "";
      input.focus();

      const thinkingRow = document.createElement("div");
      thinkingRow.className = "message-row bot";
      const thinkingBubble = document.createElement("div");
      thinkingBubble.className = "bubble thinking";
      thinkingBubble.textContent = "è€ƒãˆä¸­â€¦";
      thinkingRow.appendChild(thinkingBubble);
      chatLog.appendChild(thinkingRow);
      chatLog.scrollTop = chatLog.scrollHeight;

      sendBtn.disabled = true;

      try {
        const res = await fetch(
          `${WORKER_ENDPOINT}?q=${encodeURIComponent(text)}`
        );
        const answerText = await res.text();

        thinkingRow.remove();
        addBubble(answerText, "bot");
      } catch (err) {
        console.error(err);
        thinkingRow.remove();
        addBubble(
          "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚",
          "bot"
        );
      } finally {
        sendBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
